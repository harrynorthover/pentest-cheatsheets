# PsExec
-   **Ports:** 445/TCP (SMB)
-   **Required Group Memberships:** Administrators

https://docs.microsoft.com/en-us/sysinternals/downloads/psexec

##### Setup
![[Pasted image 20220719205449.png]]

##### Introduction
PsExec is a portable tool from Microsoft that lets you run processes remotely using any user's credentials. It’s a bit like a [remote access program](https://www.lifewire.com/free-remote-access-software-tools-2625161) but instead of controlling the computer with a mouse, [commands](https://www.lifewire.com/what-is-a-command-2625828) are sent via [Command Prompt](https://www.lifewire.com/command-prompt-2625840).

The tool works only under certain conditions. Namely, when file and printer sharing is enabled on both the local and remote computer, and when the remote machine has the _$admin_ share set up correctly to provide access to its _\Windows\_ folder.

##### Usage 

Kali 

```bash
psexec.py -hashes HASH_STRING USERNAME@IP_ADDRESS cmd.exe 
```

```bash
psexec.py DOMAIN/USERNAME@IP
```

Windows 

```cmd
psexec64.exe \\MACHINE_IP -u Administrator -p Mypass123 -i cmd.exe
```