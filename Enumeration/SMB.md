# Enumerating SMB
Below is a collection of different commands to gain infomation on SMB shares, users and much else.

Nmap scan for SMB versions

```
$ nmap -p139/445 --script smb-protocols IP_ADDRESS 
```

Nmap scan with default scripts.

```
$ nmap -sC -p 139,445 -sV IP_ADDRESS
```


List SMB shares using smbmap

```
$ smbmap -H IP_ADDRESS -R (recursive)
```


List shares using smbclient

```
$ smbclient -L IP_ADDRESS -N (no password)
```

List shares using crackmapexec

```
crackmapexec smb IP_ADDRESS -u guest -p "" --shares
```

Upload a file using SMB

```
$ smbclient //IP_ADDRESS/share -c 'cd c:/remote/path ; put LOCAL_FILE REMOTE_FILE'
```


Check credentials using *psexec.py*

```
$ python psexec.py 'USER':'PASS'@IP_ADDRESS
```


Connect anonymously to SMB share

```
$ smbclient //IPADDRESSS/SHARE -N (no password)
```


Enumerate SMB using enum4linux

```
$ enum4linux [OPTIONS] IP_ADDRESS
```


Spider SMB Shares, using crackmapexec

```
crackmapexec smb IP_ADDRESS -u guest -p "" -M spider_plus
```


Search LDAP

```
ldapsearch -x -h IP_ADDRESS -b base namingcontext
```