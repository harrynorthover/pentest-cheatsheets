# Bash utils
A collection of bash utilities.

##### **SCP**

*Basic Syntax*
```
scp username@from_host:file.txt /local/directory/to_file_dir
```

*Copy Folder*
```
scp -r user@your.server.example.com:/path/to/foo /home/user/Desktop/
```

##### **Web Server** 

*Simple HTTP*
```
python3 -m http.server 
```

*CGI* 
```
python3 -m http.server --cgi
```

*PHP*
```
php -S 0.0.0.0:PORT &>/dev/null &
```

##### Ports

Check open ports
```
ss -tulwn | grep PORT_TO_SEARCH
```

Basic Port Scanner
```
timeout 1 bash -c "echo >/dev/tcp/$host/$port" && echo "port $port is open" || echo "port $port is closed"
```

```
#!/bin/bash  
ports=(21 22 53 80 443 3306 8443 8080)  
for port in ${ports[@]}; do  
timeout 1 bash -c "echo \"Port Scan Test\" > /dev/tcp/1.1.1.1/$port && echo $port is open || /dev/null"   
done
```

netcat
```
nc -zv 192.168.100.1 1-65535
```

python
```
#!/usr/bin/python3  

import socket  
host = "X.X.X.X"  
portList = [21,22,53,80,443,3306,8443,8080]  
for port in portList:  
 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  
 try:  
  s.connect((host,port))  
  print("Port ", port, " is open")  
 except:  
  print("Port ", port, " is closed")
```

**Find and delete files** 

```
find . -name "FILE_TO_DELETE" -delete
```

#### Users 
Add user & set password
https://linux.die.net/man/8/useradd

```shell-session
useradd tunneluser -m -d /home/tunneluser -s /bin/true
passwd tunneluser
```

- d = home directory location
- m = create home directory 
- s = users login shell

Add user to *sudo* 

```
sudo adduser USERNAME sudo
sudo sh -c "echo 'USERNAME ALL=NOPASSWD: ALL' >> /etc/sudoers"
```

Manually add user to /etc/passwd

```
➜ openssl passwd -6 -salt xyz password
sudo echo "USERNAME:PASSWORDHASH:UID(0):GUI(0):USER_DESCRIPTION:HOME_DIR/:/BIN/BASH" > /etc/password
```

##### Ltrace
Read strings in an executable file.

```
ltrace FILE 
```

##### Create SSH Key
```
ssh-keygen -f USERNAME
cat USERNAME.pub > /home/USER/.ssh/authorized_keys

ssh USER@MACHINE -i USERNAME (normally the plain id_rsa, not id_rsa.pub)
```

##### Check for Write 
```
find . -type d | while read directory; do touch ${directory}/0xdf 2>/dev/null && echo "${directory} - write file" && rm ${directory}/0xdf; mkdir ${directory}/0xdf 2>/dev/null && echo "${directory} - write dir" && rmdir ${directory}/0xdf; done
```

Create different file types
```
touch {/DIRECTORY/,./}testFile.{lnk,exe,dll,ini}
```